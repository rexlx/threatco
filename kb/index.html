<!DOCTYPE HTML>
<!--
	Dimension by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

<head>
	<title>knowledge</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="assets/css/main.css" />
	<noscript>
		<link rel="stylesheet" href="assets/css/noscript.css" />
	</noscript>
</head>

<body class="is-preload">

	<!-- Wrapper -->
	<div id="wrapper">

		<!-- Header -->
		<header id="header">
			<div class="logo">
				<span class="icon fa-compass"></span>
			</div>
			<div class="content">
				<div class="inner">
					<h1 class="has-text-blue">Knowledge Center</h1>
					<p>Documentation for the threatco server and insights extension.</p>
				</div>
			</div>
			<nav>
				<ul>
					<li><a href="#frontend">frontend</a></li>
					<li><a href="#extension">extension</a></li>
					<li><a href="#server">server</a></li>
					<li><a href="#api">api</a></li>
					<li><a href="#deploy">deploy</a></li>
					<li><a href="#deps">dependencies</a></li>
					<!--<li><a href="#elements">Elements</a></li>-->
				</ul>
			</nav>
		</header>

		<!-- Main -->
		<div id="main">
			<!-- Intro -->
			<article id="frontend">
				<h2 class="major has-text-green">administration</h2>
				<p>documentation for live server administration</p>
				<h3 class="major has-text-green">login</h3>
				<span class="image main"><img src="images/home.png" alt="" /></span>
				<p>to login to the server, enter the server url in the browser, enter your credentials, and click on the
					login button</p>
				<p>you will be redirected to services screen as shown above</p>
				<h3 class="major has-text-green">users</h3>
				<span class="image main"><img src="images/users.png" alt="" /></span>
				<p class="has-text-blue">view and delete users</p>
				<p>view and delete users in the "users" menu</p>
				<span class="image main"><img src="images/adduser.png" alt="" /></span>
				<p class="has-text-blue">add a user</p>
				<p>add a user by clicking on the "add user" link in the navigation bar</p>
				<ol class="has-text-white">
					<li>click on the "add user" link in the navigation bar</li>
					<li>fill in the form with the user's details</li>
					<li>click on the "add user" button. a prompt will appear informing you of a one time key appearing
						on screen</li>
					<li>click ok and copy the one time key and give it to the user</li>
				</ol>
				<p>you can now view the user in the users section</p>
				<p class="has-text-blue">edit a user</p>
				<p>re-add a user to change their password. there is no update user function from the perspective of the forntend at this time (although the capability exists)</p>
				<h3 class="major has-text-green">services</h3>
				<p>you can view details about the the configured services here</p>
				<h3 class="major has-text-green">logging</h3>
				<p>view logs in the "logs" menu</p>
				<h3 class="major has-text-green">responses</h3>
				<p>view all cached responses in the "responses" menu</p>
				<h3 class="major has-text-green">stats</h3>
				<p>view application graphs in the "stats" menu</p>


			</article>

			<!-- Work -->
			<article id="api">
				<h2 class="major has-text-green">API</h2>
				<!-- <span class="image main"><img src="images/pic02.jpg" alt="" /></span> -->
				<p>API documentation for the threatco server and insights extension.
				<p>Authorization headers are required to make API calls and are generated by your admin.</p>
				<pre class="has-text-gray">Authorization: user@place.com:key_here</pre>
				<h3 class="major has-text-green">Endpoints</h3>
				<h4 class="has-text-blue">GET /logs</h4>
				<p>returns a list of all logs ordered by when they occured</p>
				<pre
					class="has-text-gray">[{"time":"2025-01-30T07:15:11.800719266-06:00","data":"Server started at :8081","error":false}]</pre>
				<h4 class="has-text-blue">GET /events/:id</h4>
				<p>returns the actual third party response that was cached</p>
				<h4 class="has-text-blue">POST /parse</h4>
				</p> returns a list of summarized repsonses </p>
				<pre
					class="has-text-gray">[{"timestamp":"0001-01-01T00:00:00Z","matched":true,"error":false,"background":"has-background-primary-dark","from":"deepfry","id":"1","attr_count":0,"link":"4f82d899-9572-4aa0-a584-04fe0f30168b","threat_level_id":"1","value":"8.8.8.8","info":"that IP looks nosey!"}]</pre>
				<p>requiries:
				<pre class="has-text-gray">{"blob": "text to parse"}</pre>
				</p>
				<h4 class="has-text-blue">POST /pipe</h4>
				<p>returns a summarized repsonse from the specified vendor</p>
				<pre
					class="has-text-gray">{"timestamp":"0001-01-01T00:00:00Z","matched":true,"error":false,"background":"has-background-primary-dark","from":"deepfry","id":"1","attr_count":0,"link":"4f82d899-9572-4aa0-a584-04fe0f30168b","threat_level_id":"1","value":"8.8.8.8","info":"that IP looks nosey!"}</pre>
				<p>requiries:
				<pre class="has-text-gray">{"value": "8.8.8.8", "to": "deepfry", "type": "ipv4"}</pre>
				</p>
				<p><em class="has-text-blue">optional fields:</em>
					"route": "ip_address". specifices an additional url element to add to the base url for that vendor
					if the API requests calls for it.
				</p>
				<h4 class="has-text-blue">GET /getservices</h4>
				<p>returns a list of all services available</p>
				<pre class="has-text-gray">[{"upload_service": false,"expires": 0,"secret": "","selected": false,"insecure": false,"name": "misp-dev","url": "https://192.168.86.91:443","rate_limited": false,"max_requests": 0,"refill_rate": 0,"auth_type": "","key": "","kind": "misp","type": ["md5","sha1","sha256","sha512","ipv4","ipv6","email","url","domain","filepath","filename"],"route_map": null,"description": ""}]</pre>
			</article>

			<!-- About -->
			<article id="extension">
				<h2 class="major has-text-green">extension</h2>
				<p>documentation for using the insights extension</p>
				<h3 class="major has-text-green">menu</h3>
				<span class="image main"><img src="images/menu960.png" alt="" /></span>
				<p>The services option allows the user to enable and disable the services provided by the server.
					changes made are synced to the server per user</p>
				<p>The profile option allows the user to configure the server url and email / key.</p>
				<h3 class="major has-text-green">search</h3>
				<span class="image main"><img src="images/search960.png" alt="" /></span>
				<p>the search field accepts blobs of text and will parse "indicators" from the provided data. each
					indicator match is categorized and sent to respective services configured on the server.</p>
				<p>a history of 24 results are kept in a first in first out queue</p>
				<p>a user can get exact responses with "goto" and an ID that matches a response that has not expired.
					though this can be achieved with the "view" button seen on each result</p>
			</article>

			<article id="server">
				<h2 class="major has-text-green">server</h2>
				<p>documentation for configuring and using the threatco server</p>
				<h3 class="major has-text-green">configuration</h3>
				<p>the server configuration is located in the data/config.json file. the following options are
					available:</p>
				<ul class="has-text-white">
					<li>server_id: a unique identifier for the server</li>
					<li>first_user_mode: if true, the server will only allow one user to be created</li>
					<li>bind_address: the address the server will bind to</li>
					<li>fqdn: the fully qualified domain name of the server</li>
					<li>services: a list of services the server will use</li>
					<li>http_port: the port the server will listen on for http</li>
					<li>https_port: the port the server will listen on for https</li>
					<li>http_too: if true, the server will listen on both http and https</li>
					<li>tls_cert: the path to the tls certificate</li>
					<li>tls_key: the path to the tls key</li>
					<li>cert_auth: if true, the server will require client certificates</li>
					<li>db_location: the path to the database file</li>
					<li>session_token_ttl: the time in minutes a session token will last</li>
					<li>response_cache_expiry: the time in minutes a response will last in the cache</li>
					<li>stat_cache_tick_rate: the time in minutes the server will update the stats</li>
				</ul>
				<h3 class="major has-text-green">logging</h3>
				<p>the server logs to stdout and stderr. some logs are also duplicated on the frontend and served over
					the api. There is no way to control log level currently</p>
			</article>

			<!-- Contact -->
			<article id="deps">
				<h2 class="major has-text-green">dependencies</h2>
				<h3 class="major has-text-green">server</h3>
				<p class="has-text-blue">server configuration</p>
				<p>by default, the system will use data/config.json. please view the options available for configuration
				</p>
				<p class="has-text-blue">frontend</p>
				<p>the frontend is written in html, css, and javascript. it uses the following dependencies served
					statically from the server (no CDN):</p>
				<ul class="has-text-white">
					<li>htmx</li>
					<li>IBMPlex fonts</li>
					<li>bulma css</li>
				</ul>
				<p class="has-text-blue">software dependencies</p>
				<p>the server is written in go and uses the following dependencies:</p>
				<ul class="has-text-white">
					<li>github.com/alexedwards/scs/v2 v2.8.0</li>
					<li>github.com/go-echarts/go-echarts/v2 v2.4.1</li>
					<li>github.com/google/uuid v1.6.0</li>
					<li>go.etcd.io/bbolt v1.3.11</li>
					<li>golang.org/x/crypto v0.31.0</li>
					<li>github.com/jackc/pgx/v5</li>
				</ul>
				<p class="has-text-blue">database</p>
				<p>the server requires a database connection, and supports two modes:
				<ul class="has-text-white">
					<li>embded with bbolt</li>
					<li>postgres</li>
				</ul>
				</p>
				<h3 class="major has-text-green">extension</h3>
				<p class="has-text-blue">client configuration</p>
				<p>the client configuration is located in the profile section of the menu</p>
				<p class="has-text-blue">services</p>
				<p>third party services are developed and configured server side. the user saves their preferred
					services in the services menu</p>
				<p class="has-text-blue">software dependencies</p>
				<p>the extension is written in javascript and uses the following dependencies served statically from
					chrome (no CDN):</p>
				<ul class="has-text-white">
					<li>IntelOneMono fonts</li>
					<li>bulma css</li>
				</ul>
				<h3 class="major has-text-green">knowledge base</h3>
				<p>A fully responsive site template designed by <a href="https://html5up.net">HTML5 UP</a> and
					released<br />
					for free under the <a href="https://html5up.net/license">Creative Commons</a> license.</p>
				<h3 class="major has-text-green">source code</h3>
				<p>the source code for the <a href="https://github.com/rexlx/threatco ">threatco server</a></p>
				<p>the source code for the <a href="https://github.com/rexlx/insights ">insights extension</a></p>

			</article>
			<article id="deploy">
				<h2 class="major has-text-green">deployment</h2>
				<p>documentation for installing threatco. see dependencies to ensure smooth installation</p>
				<h3 class="major has-text-green">system requirements</h3>
				<p class="has-text-blue">operating system</p>
				<p>the server has been tested on linux, mac, and windows. Linux is the recomended OS</p>
				<p class="has-text-blue">hardware</p>
				<p>The memory and cpu requirments will scale up with users and usage. for deployments handling less than
					100 rps, any deployment will likely suffice. if you want to handle thousands of requests a second
					with little or no network latency, I recommend:</p>
				<ul class="has-text-white">
					<li>6 cores</li>
					<li>8GB of ram</li>
					<li>128+ GiB storage</li>
				</ul>
				<p class="has-text-blue">software</p>
				<p>the server requires go 1.23 or higher and git</p>
				<h3 class="major has-text-green">basic install</h3>
				<p>clone the repository</p>
				<pre class="has-text-gray">git clone https://github.com/rexlx/threatco.git</pre>
				<p>cd into the directory</p>
				<pre class="has-text-gray">cd threatco</pre>
				<p>build the server</p>
				<pre class="has-text-gray">go build .</pre>
				<p>view the config and consider options</p>
				<pre class="has-text-gray">./threatco -h;vim data/config.json</pre>
				<p>run the server</p>
				<pre
					class="has-text-gray">./threatco -static "./static" -config data/config.json -db "user=postgres password=tacointhealley host=192.168.86.120 dbname=threatco" -kb ./kb/</pre>
				<p>the servers default flags are written for docker, which is why so many have to be supplied when
					running bare metal.</p>
				<p>they can be overwritten in server.go to run with less flags</p>
				<p class="has-text-blue">server options</p>
				<ul class="has-text-white">
					<li>-static: the path to the static files for the server frontend</li>
					<li>-config: the path to the config file</li>
					<li>-db: the database connection string OR embedded db file location</li>
					<li>-kb: the path to the knowledge base. without this flag the server wont host the knowledge base</li>
					<li>-delete (optional): delete the config file after reading it</li>
					<li>-firstuse (optional): leaves api route for creating users unprotected</li>
					<li>-fqdn (optional): set the url of the server</li>
				</ul>
				<h3 class="major has-text-green">docker / podman</h3>
				<p>build the image</p>
				<pre class="has-text-gray">docker build -t threatco .</pre>
				<p>run the image</p>
				<pre class="has-text-gray">docker run -d -p 8081:8081 threatco</pre>
				<p>there is also a docker-compose.yml for docker-compose</p>
			</article>
			<!-- <article id="deps">
				<h2 class="major has-text-green">Contact</h2>
				<form method="post" action="#">
					<div class="fields">
						<div class="field half">
							<label for="name">Name</label>
							<input type="text" name="name" id="name" />
						</div>
						<div class="field half">
							<label for="email">Email</label>
							<input type="text" name="email" id="email" />
						</div>
						<div class="field">
							<label for="message">Message</label>
							<textarea name="message" id="message" rows="4"></textarea>
						</div>
					</div>
					<ul class="actions">
						<li><input type="submit" value="Send Message" class="primary" /></li>
						<li><input type="reset" value="Reset" /></li>
					</ul>
				</form>
				<ul class="icons">
					<li><a href="#" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
					<li><a href="#" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
					<li><a href="#" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>
					<li><a href="#" class="icon brands fa-github"><span class="label">GitHub</span></a></li>
				</ul>
			</article> -->

		</div>

		<!-- Footer -->
		<footer id="footer">
			<p>rxlx@nullferatu.com</p>
		</footer>

	</div>

	<!-- BG -->
	<div id="bg"></div>

	<!-- Scripts -->
	<script src="assets/js/jquery.min.js"></script>
	<script src="assets/js/browser.min.js"></script>
	<script src="assets/js/breakpoints.min.js"></script>
	<script src="assets/js/util.js"></script>
	<script src="assets/js/main.js"></script>

</body>

</html>